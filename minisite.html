<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>Minisite</title>
	<script>
		const data = `[a][/][b][/]`;
// 		`
// [body]
// [h1]Big header[/]
// Here is some text that's cool I guess.
// [bul]
// [a link=""][h2]Page 1[/][/]
// Here's some info on page 1.
// [/]
// [bul]
// [a link=""][h2]Page 2[/][/]
// Here's some info on page 2.
// [/]
// [/]
// 		`;

		const opening_tag_regex = /^\[[^\[\]]+\]/;

		class Node {
			constructor(tag_name, child_nodes) {
				this.tag_name = tag_name;
				this.child_nodes = child_nodes;
				// TODO attributes, e.g. link="google.com"
			}
		}

		function parse(string) { // recursive function, returns { nodes: list of node objects, string: reduced string after parsing }

			// no more siblings to parse
			if (string.length == 0 || string.startsWith("[/]")) {

				return {
					nodes: [],
					string: string
				};
			}

			// parse next sibling node
			if (opening_tag_regex.test(string)) {

				string = string.replace(opening_tag_regex, "");	// remove opening tag
				({ nodes, string } = parse(string));			// parse child nodes of this node
				string = string.replace("[/]", "");				// remove closing tag

				let children = nodes;

				({ nodes, string } = parse(string));			// parse following siblings

				return {
					nodes: [ new Node("?", children) ].concat(nodes),
					string: string
				};
			}

			// parse next sibling text
			string = string.substring(string.search(opening_tag_regex) != -1 ? string.search(opening_tag_regex) : string.indexOf("[/]") != -1 ? string.indexOf("[/]") : string.length);

			// parse following siblings
			({ nodes, string } = parse(string));

			return {
				nodes: [ new Node("text", []) ].concat(nodes),
				string: string
			};
		}

		console.log(parse(data));
	</script>
</head>
<body>
	<img src="minisite.png" height="400"><br>
</body>
</html>