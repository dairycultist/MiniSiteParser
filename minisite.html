<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>Minisite</title>
	<script>
		const data =
		`[body]dog[h1]Big header[/]cat[/]`;
// Here is some text that's cool I guess.
// [bul]
// [a link=""][h2]Page 1[/][/]
// Here's some info on page 1.
// [/]
// [bul]
// [a link=""][h2]Page 2[/][/]
// Here's some info on page 2.
// [/]
// [/]
// 		`;

		const opening_tag_regex = /\[([^\[\]]+)\]/;

		class Node {

			constructor(tag_name, child_nodes) {
				this.tag_name = tag_name;
				this.child_nodes = child_nodes;
				// TODO attributes, e.g. link="google.com"
			}

			to_html() {
				return "cat";
			}
		}

		function parse(string) { // recursive function, returns { nodes: list of node objects, string: reduced string after parsing }

			// no more siblings to parse
			if (string.length == 0 || string.startsWith("[/]")) {

				return {
					nodes: [],
					string: string
				};
			}

			// parse next sibling node
			if (string.search(opening_tag_regex) == 0) {

				const opening_tag = opening_tag_regex.exec(string);

				string = string.substring(opening_tag[0].length);	// remove opening tag
				({ nodes, string } = parse(string));				// parse child nodes of this node
				string = string.replace("[/]", "");					// remove closing tag

				let children = nodes;

				({ nodes, string } = parse(string));			// parse following siblings

				return {
					nodes: [ new Node(opening_tag[1], children) ].concat(nodes),
					string: string
				};
			}

			// parse next sibling text
			if (string.search(opening_tag_regex) != -1) {

				string = string.substring(string.search(opening_tag_regex));

				({ nodes, string } = parse(string)); // parse following siblings

				return {
					nodes: [ new Node("text", []) ].concat(nodes),
					string: string
				};

			} else {

				string = string.substring(string.indexOf("[/]") != -1 ? string.indexOf("[/]") : string.length);

				return {
					nodes: [ new Node("text", []) ],
					string: string
				};
			}
		}
	</script>
</head>
<body onload="document.body.innerHTML = new Node('body', parse(data).nodes).to_html();">
	<img src="minisite.png" height="400"><br>
</body>
</html>